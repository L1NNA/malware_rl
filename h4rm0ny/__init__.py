
def init():
    from sklearn.model_selection import train_test_split
    from gym.envs.registration import register
    from h4rm0ny.envs.utils import interface


    # create a holdout set

    sha256_train  = interface.get_available_sha256('/home/jovyan/Research/h4rm0ny/malconv/rl_train_exp.csv')
    sha256_holdout  = interface.get_available_sha256('/home/jovyan/Research/h4rm0ny/malconv/rl_test_exp.csv')



    MAXTURNS = 50
    #register a new malconv environment for h4rm0ny training
    #no uptraining
    register(
        id='malconv-train-v0',
        entry_point='h4rm0ny.envs:MalConvEnv',
        kwargs={
            'random_sample': True,
            'maxturns': MAXTURNS,
            'sha256list': sha256_train,
            'output_path': 'data/evaded/malconv_ember'
        }
    )
    #uptraining
    register(
        id='malconv-uptrain-v0',
        entry_point='h4rm0ny.envs:MalConvEnv',
        kwargs={
            'random_sample': True,
            'maxturns': MAXTURNS,
            'sha256list': sha256_train,
            'uptrain': True,
            'output_path': 'data/evaded/malconv_uptrain'
        }
    )




    register(
        id='malconv-train-v1',
        entry_point='h4rm0ny.envs:MalConvEnv',
        kwargs={
            'random_sample': True,
            'maxturns': MAXTURNS,
            'sha256list': sha256_train,
            'output_path': 'data/evaded/malconv_ember',
            'agent': 'acer'
        }
    )
    #uptraining
    register(
        id='malconv-uptrain-v1',
        entry_point='h4rm0ny.envs:MalConvEnv',
        kwargs={
            'random_sample': True,
            'maxturns': MAXTURNS,
            'sha256list': sha256_train,
            'uptrain': True,
            'output_path': 'data/evaded/malconv_uptrain',
            'agent' : 'ddqn'
        }
    )


    #register a new malconv environment for h4rm0ny testing
    register(
        id='malconv-test-v0',
        entry_point='h4rm0ny.envs:MalConvEnv',
        kwargs={
            'random_sample': False,
            'maxturns': MAXTURNS,
            'sha256list': sha256_holdout
        }
    )





